generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

generator typescriptInterfaces {
  provider = "prisma-generator-typescript-interfaces"
  output   = "../../shared/src/types/prisma.types.ts"
  prettier = true
  // exportEnums = true
  modelType = "type"
  // enumType = "enum"
  // enumSuffix = "Enum"
}

datasource db {
  provider = "postgresql"
}

model Building {
  id           Int          @id @default(autoincrement())
  name         String
  description  String?      @db.Text
  yearBuilt    Int          @map("year_built")
  propertyType PropertyType @default(RESIDENTIAL) @map("property_type")
  address      String
  district     String
  city         String
  province     String
  postalCode   String?      @map("postal_code")
  floors       Int
  // commonAreas  CommonArea[]
  // staff        Staff[]
  phoneNumber  String?      @map("phone_number")
  email        String?      @unique
  isActive     Boolean      @default(true) @map("is_active")
  createdAt    DateTime     @default(now()) @db.Timestamptz(6) @map("created_at")
  updatedAt    DateTime     @updatedAt @db.Timestamptz(6) @map("updated_at")
  // units        Unit[]

  @@map("buildings")
}

model User {
  id        Int      @id @default(autoincrement())
  email     String   @unique
  password  String
  role      UserRole
  firstName String @map("first_name")
  lastName  String @map("last_name")
  createdAt DateTime @default(now())  @db.Timestamptz(6) @map("created_at")
  updatedAt DateTime @updatedAt @db.Timestamptz(6) @map("updated_at")
  Staff     Staff[]

  @@map("users")
}

model Unit {
  id         Int        @id @default(autoincrement())
  buildingId Int       @map("building_id")
  // building   Building   @relation(fields: [buildingId], references: [id])
  number     String
  floor      Int
  type       UnitType
  status     UnitStatus
  createdAt  DateTime   @default(now()) @db.Timestamptz(6) @map("created_at")
  updatedAt  DateTime   @updatedAt @db.Timestamptz(6) @map("updated_at")

  @@unique([buildingId, floor, number])
  @@index([buildingId])
  @@map("units")
}

model CommonArea {
  id          Int      @id @default(autoincrement())
  buildingId  Int      @map("building_id")
  // building    Building @relation(fields: [buildingId], references: [id])
  name        String
  description String?
  capacity    Int
  isActive    Boolean  @default(true) @map("is_active")
  createdAt   DateTime @default(now()) @db.Timestamptz(6) @map("created_at")
  updatedAt   DateTime @updatedAt @db.Timestamptz(6) @map("updated_at")

  @@map("common_areas")
}

model Staff {
  id         Int       @id @default(autoincrement())
  buildingId Int      @map("building_id")
  // building   Building  @relation(fields: [buildingId], references: [id])
  userId     Int      @map("user_id")
  user       User      @relation(fields: [userId], references: [id])
  role       StaffRole
  startDate  DateTime   @db.Timestamptz(6) @map("start_date")
  endDate    DateTime?  @db.Timestamptz(6) @map("end_date")
  createdAt  DateTime  @default(now()) @db.Timestamptz(6) @map("created_at")
  updatedAt  DateTime  @updatedAt @db.Timestamptz(6) @map("updated_at")

  @@map("staff")
}

enum UnitType {
  APARTMENT
  OFFICE
  COMMERCIAL
}

enum UnitStatus {
  AVAILABLE
  OCCUPIED
  MAINTENANCE
}

enum StaffRole {
  MANAGER
  SECURITY
  MAINTENANCE
  OTHER
}

enum PropertyType {
  RESIDENTIAL
  COMMERCIAL
  MIXED
}

enum UserRole {
  ADMIN
  MANAGER
  RESIDENT
  STAFF
}
